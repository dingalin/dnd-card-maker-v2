<!-- Assembly Table - Visual Card Creation Interface -->
<div id="tab-assembly-table" class="tab-content hidden">
    <main class="assembly-layout">

        <!-- Right Panel (RTL first = visual right): Actions Console -->
        <aside class="assembly-console glass-panel">
            <h3 data-i18n="assembly.console">קונסולת פעולות</h3>

            <!-- Build Summary -->
            <div class="console-summary" id="assembly-build-summary">
                <p class="summary-empty" data-i18n="assembly.summaryEmpty">בחר רכיבים להתחלה...</p>
            </div>

            <!-- Power Budget Display -->
            <div class="power-budget-display" id="power-budget-display">
                <!-- Rarity Selector -->
                <div class="budget-rarity-selector">
                    <label data-i18n="assembly.targetRarity">נדירות יעד:</label>
                    <select id="budget-rarity-select">
                        <option value="Common" data-icon="⚪">⚪ רגיל</option>
                        <option value="Uncommon" data-icon="🟢">🟢 לא נפוץ</option>
                        <option value="Rare" selected data-icon="🔵">🔵 נדיר</option>
                        <option value="Very Rare" data-icon="🟣">🟣 נדיר מאוד</option>
                        <option value="Legendary" data-icon="🟠">🟠 אגדי</option>
                    </select>
                </div>
                <!-- Points Bar -->
                <div class="budget-points">
                    <div class="budget-bar">
                        <div class="budget-filled" id="budget-filled" style="width: 0%"></div>
                    </div>
                    <span class="budget-text">
                        <span id="budget-current">0</span> / <span id="budget-max">8</span> נקודות
                    </span>
                </div>
            </div>

            <!-- Background Selection Buttons -->
            <div class="console-bg-selector">
                <button type="button" id="assembly-select-bg" class="btn-secondary">
                    <span class="icon">🂴</span>
                    <span data-i18n="assembly.selectBackground">בחר רקע קלף</span>
                </button>
                <button type="button" id="assembly-generate-bg" class="btn-secondary">
                    <span class="icon">✨</span>
                    <span data-i18n="assembly.generateBackground">צור רקע חדש</span>
                </button>
            </div>

            <!-- Category Buttons (moved from dock) -->
            <div class="console-categories" id="assembly-categories">
                <button class="dock-category active" data-category="base">
                    <span class="category-icon">⚔️</span>
                    <span class="category-label" data-i18n="assembly.catBase">בסיס</span>
                </button>
                <button class="dock-category" data-category="element">
                    <span class="category-icon">🔥</span>
                    <span class="category-label" data-i18n="assembly.catElement">אלמנט</span>
                </button>
                <button class="dock-category" data-category="rarity">
                    <span class="category-icon">💎</span>
                    <span class="category-label" data-i18n="assembly.catRarity">נדירות</span>
                </button>
                <button class="dock-category" data-category="ability">
                    <span class="category-icon">✨</span>
                    <span class="category-label" data-i18n="assembly.catAbility">יכולות</span>
                </button>
            </div>

            <!-- Action Buttons -->
            <div class="assembly-actions">
                <button type="button" id="assembly-generate-btn" class="btn-create" disabled>
                    <span class="icon">✨</span>
                    <span data-i18n="assembly.generate">צור קלף</span>
                </button>
                <button type="button" id="assembly-clear-btn" class="btn-secondary">
                    <span class="icon">🗑️</span>
                    <span data-i18n="assembly.clear">נקה הכל</span>
                </button>
            </div>
        </aside>

        <!-- Center: Real Card Canvas with Overlay Sockets -->
        <section class="assembly-canvas">
            <!-- Background buttons moved to console panel -->

            <!-- Card Wrapper with Canvas and Overlay Sockets -->
            <div class="assembly-card-wrapper" id="assembly-card">
                <!-- Real Canvas for Card Rendering -->
                <canvas id="assembly-canvas" width="600" height="840"></canvas>

                <!-- Unified Drop Zone - covers entire card -->
                <div class="assembly-drop-zone" id="assembly-drop-zone">
                    <span class="drop-hint" data-i18n="assembly.dropHint">גרור רכיבים לכאן</span>
                </div>
            </div>
        </section>

        <!-- Left Panel (RTL last = visual left): Detail Scroll -->
        <aside class="assembly-detail-scroll glass-panel">
            <h3 data-i18n="assembly.details">פרטי הקלף</h3>

            <!-- Inline Name Editor -->
            <div class="detail-field">
                <label data-i18n="assembly.itemName">שם הפריט</label>
                <input type="text" id="assembly-item-name" placeholder="לחץ לעריכה..."
                    data-i18n-placeholder="assembly.namePlaceholder">
            </div>

            <!-- Power Budget Mini Display -->
            <div class="assembly-power-budget">
                <div class="power-header">
                    <span class="power-icon">⚡</span>
                    <span data-i18n="assembly.powerBudget">תקציב כוח</span>
                </div>
                <div class="power-bar-container">
                    <div class="power-bar-fill" id="assembly-power-fill"></div>
                    <span class="power-text" id="assembly-power-text">0/10</span>
                </div>
                <div class="power-breakdown" id="assembly-power-breakdown">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Flavor Text -->
            <div class="detail-field">
                <label data-i18n="assembly.flavorText">טקסט פלאף</label>
                <textarea id="assembly-flavor-text" rows="3" placeholder="תיאור אווירה..."
                    data-i18n-placeholder="assembly.flavorPlaceholder"></textarea>
            </div>
        </aside>

        <!-- Bottom: Two-Tier Component Dock -->
        <nav class="assembly-dock">
            <!-- Categories now in console panel -->
            <!-- Sub-Categories Row (Dynamic) -->
            <div class="dock-subcategories" id="assembly-subcategories">
                <!-- Base subcategories (default) -->
                <button class="dock-subcategory active" data-subcategory="simple-melee">נשק פשוט קרבי</button>
                <button class="dock-subcategory" data-subcategory="simple-ranged">נשק פשוט ירייה</button>
                <button class="dock-subcategory" data-subcategory="martial-melee">נשק מרשל קרבי</button>
                <button class="dock-subcategory" data-subcategory="martial-ranged">נשק מרשל ירייה</button>
                <button class="dock-subcategory" data-subcategory="armor">שריון</button>
                <button class="dock-subcategory" data-subcategory="wondrous">חפצי פלא</button>
            </div>

            <!-- Items Row (Scrollable, Draggable) -->
            <div class="dock-items-container">
                <button class="dock-scroll-btn scroll-left" id="dock-scroll-left">◀</button>
                <div class="dock-items" id="assembly-items">
                    <!-- Items populated dynamically based on category/subcategory -->
                    <!-- Example tokens: -->
                    <div class="dock-token" draggable="true" data-token-type="base" data-token-id="longsword">
                        <span class="token-icon">🗡️</span>
                        <span class="token-label">חרב ארוכה</span>
                        <span class="token-cost">0</span>
                    </div>
                    <div class="dock-token" draggable="true" data-token-type="base" data-token-id="battleaxe">
                        <span class="token-icon">🪓</span>
                        <span class="token-label">גרזן קרב</span>
                        <span class="token-cost">0</span>
                    </div>
                    <div class="dock-token" draggable="true" data-token-type="base" data-token-id="greatsword">
                        <span class="token-icon">⚔️</span>
                        <span class="token-label">חרב דו-ידנית</span>
                        <span class="token-cost">0</span>
                    </div>
                </div>
                <button class="dock-scroll-btn scroll-right" id="dock-scroll-right">▶</button>
            </div>
        </nav>

    </main>
</div>